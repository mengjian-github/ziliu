// å¹³å°ç‰¹å®šçš„å‘å¸ƒè®¾ç½®ç±»å‹å®šä¹‰

// å›¾æ–‡å¹³å°
export type TextPlatform = 'wechat' | 'zhihu' | 'juejin' | 'zsxq';
// è§†é¢‘å¹³å°
export type VideoPlatform = 'video_wechat' | 'douyin' | 'bilibili' | 'xiaohongshu';
// æ‰€æœ‰å¹³å°
export type Platform = TextPlatform | VideoPlatform;

// åŸºç¡€å‘å¸ƒè®¾ç½®
export interface BasePlatformSettings {
  id: string;
  name: string;
  platform: Platform;
  isDefault?: boolean;
  authorName?: string;
  autoGenerateDigest?: boolean;
  headerContent?: string;
  footerContent?: string;
}

// è§†é¢‘å¹³å°ç‰¹æœ‰è®¾ç½®
export interface VideoSettings {
  speechScript?: string;        // å£æ’­ç¨¿
  videoTitle?: string;          // è§†é¢‘æ ‡é¢˜
  videoDescription?: string;    // è§†é¢‘æè¿°
  videoTags?: string[];        // è§†é¢‘æ ‡ç­¾
  platformTips?: string[];     // å¹³å°ç‰¹å®šå»ºè®®
}

// å¹³å°ç‰¹å®šé…ç½®ï¼ˆæš‚æ—¶ä¿æŒç®€å•ï¼Œåªæœ‰åŸºç¡€å­—æ®µï¼‰
export interface PlatformConfig {
  // é¢„ç•™ç»™æœªæ¥æ‰©å±•çš„å¹³å°ç‰¹å®šå­—æ®µ
  [key: string]: any;
}

// å®Œæ•´çš„å¹³å°è®¾ç½®
export interface PlatformSettings extends BasePlatformSettings {
  platformConfig?: PlatformConfig;
  // å¦‚æœæ˜¯è§†é¢‘å¹³å°ï¼ŒåŒ…å«è§†é¢‘ç‰¹æœ‰è®¾ç½®
  videoSettings?: VideoSettings;
}

// ç®€åŒ–çš„å¹³å°ç‰¹å®šè®¾ç½®ç±»å‹
export interface WechatSettings extends BasePlatformSettings {
  platform: 'wechat';
}

export interface ZhihuSettings extends BasePlatformSettings {
  platform: 'zhihu';
}

export interface JuejinSettings extends BasePlatformSettings {
  platform: 'juejin';
}

export interface ZsxqSettings extends BasePlatformSettings {
  platform: 'zsxq';
  groupIds?: string[]; // çŸ¥è¯†æ˜ŸçƒIDåˆ—è¡¨ï¼Œæ”¯æŒå¤šä¸ªæ˜Ÿçƒ
}

// è§†é¢‘å¹³å°è®¾ç½®
export interface VideoWechatSettings extends BasePlatformSettings {
  platform: 'video_wechat';
}

export interface DouyinSettings extends BasePlatformSettings {
  platform: 'douyin';
}

export interface BilibiliSettings extends BasePlatformSettings {
  platform: 'bilibili';
}

export interface XiaohongshuSettings extends BasePlatformSettings {
  platform: 'xiaohongshu';
}

// å¹³å°ä¿¡æ¯
export interface PlatformInfo {
  id: Platform;
  name: string;
  icon: string;
  color: string;
  description: string;
  supportedFeatures: string[];
}

// å¹³å°é…ç½®æ˜ å°„
export const PLATFORM_CONFIGS: Record<Platform, PlatformInfo> = {
  wechat: {
    id: 'wechat',
    name: 'å¾®ä¿¡å…¬ä¼—å·',
    icon: 'ğŸ“±',
    color: 'bg-green-500',
    description: 'å¾®ä¿¡å…¬ä¼—å·æ–‡ç« å‘å¸ƒ',
    supportedFeatures: ['åŸåˆ›æ ‡è®°', 'èµèµåŠŸèƒ½', 'ç•™è¨€åŠŸèƒ½', 'ç²¾é€‰æ–‡ç« ', 'å®šåˆ¶å¡ç‰‡']
  },
  zhihu: {
    id: 'zhihu',
    name: 'çŸ¥ä¹',
    icon: 'ğŸ”µ',
    color: 'bg-blue-500',
    description: 'çŸ¥ä¹ä¸“æ æ–‡ç« å‘å¸ƒ',
    supportedFeatures: ['ä¸“æ é€‰æ‹©', 'æ ‡ç­¾è®¾ç½®', 'è¯é¢˜å…³è”', 'è¯„è®ºè®¾ç½®']
  },
  juejin: {
    id: 'juejin',
    name: 'æ˜é‡‘',
    icon: 'âš¡',
    color: 'bg-cyan-500',
    description: 'æ˜é‡‘æŠ€æœ¯æ–‡ç« å‘å¸ƒ',
    supportedFeatures: ['åˆ†ç±»é€‰æ‹©', 'æ ‡ç­¾è®¾ç½®', 'éš¾åº¦ç­‰çº§', 'å°é¢å›¾ç‰‡']
  },
  zsxq: {
    id: 'zsxq',
    name: 'çŸ¥è¯†æ˜Ÿçƒ',
    icon: 'ğŸŒŸ',
    color: 'bg-yellow-500',
    description: 'çŸ¥è¯†æ˜Ÿçƒæ–‡ç« å’Œä¸»é¢˜å‘å¸ƒ',
    supportedFeatures: ['å¤šæ˜Ÿçƒå‘å¸ƒ', 'å¯Œæ–‡æœ¬ç¼–è¾‘', 'Markdownæ”¯æŒ', 'æ–‡ç« æ¨¡å¼', 'ä¸»é¢˜æ¨¡å¼']
  },
  video_wechat: {
    id: 'video_wechat',
    name: 'è§†é¢‘å·',
    icon: 'ğŸ“¹',
    color: 'bg-green-600',
    description: 'å¾®ä¿¡è§†é¢‘å·å‘å¸ƒ',
    supportedFeatures: ['å£æ’­ç¨¿è½¬æ¢', 'çŸ­æ ‡é¢˜ç”Ÿæˆ', 'è¯é¢˜æ ‡ç­¾', 'ä½ç½®ä¿¡æ¯', 'åˆé›†ç®¡ç†']
  },
  douyin: {
    id: 'douyin',
    name: 'æŠ–éŸ³',
    icon: 'ğŸµ',
    color: 'bg-black',
    description: 'æŠ–éŸ³çŸ­è§†é¢‘å‘å¸ƒ',
    supportedFeatures: ['çˆ†æ¬¾æ ‡é¢˜', 'çƒ­é—¨æ ‡ç­¾', 'éŸ³ä¹æ¨è', 'å°é¢å»ºè®®', 'å‘å¸ƒæ—¶æœº']
  },
  bilibili: {
    id: 'bilibili',
    name: 'Bç«™',
    icon: 'ğŸ“º',
    color: 'bg-pink-500',
    description: 'Bç«™è§†é¢‘æŠ•ç¨¿',
    supportedFeatures: ['åˆ†åŒºé€‰æ‹©', 'æ ‡ç­¾ä¼˜åŒ–', 'å°é¢è®¾è®¡', 'ç®€ä»‹æ’°å†™', 'æŠ•ç¨¿å£°æ˜']
  },
  xiaohongshu: {
    id: 'xiaohongshu',
    name: 'å°çº¢ä¹¦',
    icon: 'ğŸ“–',
    color: 'bg-red-500',
    description: 'å°çº¢ä¹¦è§†é¢‘ç¬”è®°å‘å¸ƒ',
    supportedFeatures: ['ç§è‰æ–‡æ¡ˆ', 'æ ‡ç­¾æ¨è', 'åœ°ç‚¹æ·»åŠ ', 'å°é¢ä¼˜åŒ–', 'äº’åŠ¨å¼•å¯¼']
  }
};

// å¹³å°ç±»å‹åˆ¤æ–­å·¥å…·å‡½æ•°
export function isVideoPlatform(platform: Platform): platform is VideoPlatform {
  return ['video_wechat', 'douyin', 'bilibili', 'xiaohongshu'].includes(platform as VideoPlatform);
}

export function isTextPlatform(platform: Platform): platform is TextPlatform {
  return ['wechat', 'zhihu', 'juejin', 'zsxq'].includes(platform as TextPlatform);
}

// è·å–å¹³å°ç±»å‹
export function getPlatformType(platform: Platform): 'text' | 'video' {
  return isVideoPlatform(platform) ? 'video' : 'text';
}

// è·å–å¹³å°é»˜è®¤é…ç½®ï¼ˆæš‚æ—¶è¿”å›ç©ºå¯¹è±¡ï¼Œæœªæ¥æ‰©å±•æ—¶æ·»åŠ å¹³å°ç‰¹å®šå­—æ®µï¼‰
export function getDefaultPlatformConfig(platform: Platform): PlatformConfig {
  return {};
}
