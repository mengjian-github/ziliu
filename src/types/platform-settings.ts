// å¹³å°ç‰¹å®šçš„å‘å¸ƒè®¾ç½®ç±»å‹å®šä¹‰

// é•¿å›¾æ–‡å¹³å°ï¼ˆæ–‡ç« /é•¿æ–‡ï¼‰
export type LongTextPlatform = 'wechat' | 'zhihu' | 'juejin' | 'zsxq';

// çŸ­å›¾æ–‡å¹³å°ï¼ˆçŸ­æ–‡æ¡ˆ/é…å›¾ï¼‰
export type ShortTextPlatform =
  | 'wechat_xiaolushu'
  | 'xiaohongshu_note'
  | 'weibo'
  | 'jike'
  | 'x'
  | 'linkedin';

// æ–‡æœ¬å¹³å°ï¼ˆé•¿å›¾æ–‡ + çŸ­å›¾æ–‡ï¼‰
export type TextPlatform = LongTextPlatform | ShortTextPlatform;
// è§†é¢‘å¹³å°
export type VideoPlatform = 'video_wechat' | 'douyin' | 'bilibili' | 'xiaohongshu' | 'youtube';
// æ‰€æœ‰å¹³å°
export type Platform = TextPlatform | VideoPlatform;

// åŸºç¡€å‘å¸ƒè®¾ç½®
export interface BasePlatformSettings {
  id: string;
  name: string;
  platform: Platform;
  isDefault?: boolean;
  authorName?: string;
  autoGenerateDigest?: boolean;
  headerContent?: string;
  footerContent?: string;
}

// è§†é¢‘å¹³å°ç‰¹æœ‰è®¾ç½®
export interface VideoSettings {
  speechScript?: string;        // å£æ’­ç¨¿
  videoTitle?: string;          // è§†é¢‘æ ‡é¢˜
  videoDescription?: string;    // è§†é¢‘æè¿°
  videoTags?: string[];        // è§†é¢‘æ ‡ç­¾
  coverImage?: string;         // é»˜è®¤å°é¢å›¾ç‰‡ï¼ˆBase64 data URLï¼‰
  coverImage169?: string;      // 16:9 å°é¢
  coverImage43?: string;       // 4:3 å°é¢
  platformTips?: string[];     // å¹³å°ç‰¹å®šå»ºè®®
}

// å¹³å°ç‰¹å®šé…ç½®ï¼ˆæš‚æ—¶ä¿æŒç®€å•ï¼Œåªæœ‰åŸºç¡€å­—æ®µï¼‰
export interface PlatformConfig {
  // é¢„ç•™ç»™æœªæ¥æ‰©å±•çš„å¹³å°ç‰¹å®šå­—æ®µ
  [key: string]: any;
}

// å®Œæ•´çš„å¹³å°è®¾ç½®
export interface PlatformSettings extends BasePlatformSettings {
  platformConfig?: PlatformConfig;
  // å¦‚æœæ˜¯è§†é¢‘å¹³å°ï¼ŒåŒ…å«è§†é¢‘ç‰¹æœ‰è®¾ç½®
  videoSettings?: VideoSettings;
}

// ç®€åŒ–çš„å¹³å°ç‰¹å®šè®¾ç½®ç±»å‹
export interface WechatSettings extends BasePlatformSettings {
  platform: 'wechat';
}

export interface WechatXiaolushuSettings extends BasePlatformSettings {
  platform: 'wechat_xiaolushu';
}

export interface ZhihuSettings extends BasePlatformSettings {
  platform: 'zhihu';
}

export interface JuejinSettings extends BasePlatformSettings {
  platform: 'juejin';
}

export interface ZsxqSettings extends BasePlatformSettings {
  platform: 'zsxq';
  groupIds?: string[]; // çŸ¥è¯†æ˜ŸçƒIDåˆ—è¡¨ï¼Œæ”¯æŒå¤šä¸ªæ˜Ÿçƒ
}

// çŸ­å›¾æ–‡å¹³å°è®¾ç½®
export interface XiaohongshuSettings extends BasePlatformSettings {
  platform: 'xiaohongshu';
}

export interface XiaohongshuNoteSettings extends BasePlatformSettings {
  platform: 'xiaohongshu_note';
}

export interface WeiboSettings extends BasePlatformSettings {
  platform: 'weibo';
}

export interface JikeSettings extends BasePlatformSettings {
  platform: 'jike';
}

export interface XSettings extends BasePlatformSettings {
  platform: 'x';
}

export interface LinkedInSettings extends BasePlatformSettings {
  platform: 'linkedin';
}

// è§†é¢‘å¹³å°è®¾ç½®
export interface VideoWechatSettings extends BasePlatformSettings {
  platform: 'video_wechat';
}

export interface DouyinSettings extends BasePlatformSettings {
  platform: 'douyin';
}

export interface BilibiliSettings extends BasePlatformSettings {
  platform: 'bilibili';
}

export interface YouTubeSettings extends BasePlatformSettings {
  platform: 'youtube';
}

// å¹³å°ä¿¡æ¯
export interface PlatformInfo {
  id: Platform;
  name: string;
  icon: string;
  color: string;
  description: string;
  supportedFeatures: string[];
}

// å¹³å°é…ç½®æ˜ å°„
export const PLATFORM_CONFIGS: Record<Platform, PlatformInfo> = {
  wechat: {
    id: 'wechat',
    name: 'å¾®ä¿¡å…¬ä¼—å·',
    icon: 'ğŸ“±',
    color: 'bg-green-500',
    description: 'å¾®ä¿¡å…¬ä¼—å·æ–‡ç« å‘å¸ƒ',
    supportedFeatures: ['åŸåˆ›æ ‡è®°', 'èµèµåŠŸèƒ½', 'ç•™è¨€åŠŸèƒ½', 'ç²¾é€‰æ–‡ç« ', 'å®šåˆ¶å¡ç‰‡']
  },
  wechat_xiaolushu: {
    id: 'wechat_xiaolushu',
    name: 'å°ç»¿ä¹¦',
    icon: 'ğŸŸ¢',
    color: 'bg-emerald-600',
    description: 'å¾®ä¿¡å°ç»¿ä¹¦å‘å¸ƒï¼ˆä¸å…¬ä¼—å·åŒç¼–è¾‘å™¨ï¼‰',
    supportedFeatures: ['æ ‡é¢˜ï¼ˆå¯é€‰ï¼‰', 'çŸ­å›¾æ–‡æ­£æ–‡', 'é…å›¾ä¸Šä¼ ']
  },
  zhihu: {
    id: 'zhihu',
    name: 'çŸ¥ä¹',
    icon: 'ğŸ”µ',
    color: 'bg-blue-500',
    description: 'çŸ¥ä¹ä¸“æ æ–‡ç« å‘å¸ƒ',
    supportedFeatures: ['ä¸“æ é€‰æ‹©', 'æ ‡ç­¾è®¾ç½®', 'è¯é¢˜å…³è”', 'è¯„è®ºè®¾ç½®']
  },
  juejin: {
    id: 'juejin',
    name: 'æ˜é‡‘',
    icon: 'âš¡',
    color: 'bg-cyan-500',
    description: 'æ˜é‡‘æŠ€æœ¯æ–‡ç« å‘å¸ƒ',
    supportedFeatures: ['åˆ†ç±»é€‰æ‹©', 'æ ‡ç­¾è®¾ç½®', 'éš¾åº¦ç­‰çº§', 'å°é¢å›¾ç‰‡']
  },
  zsxq: {
    id: 'zsxq',
    name: 'çŸ¥è¯†æ˜Ÿçƒ',
    icon: 'ğŸŒŸ',
    color: 'bg-yellow-500',
    description: 'çŸ¥è¯†æ˜Ÿçƒæ–‡ç« å’Œä¸»é¢˜å‘å¸ƒ',
    supportedFeatures: ['å¤šæ˜Ÿçƒå‘å¸ƒ', 'å¯Œæ–‡æœ¬ç¼–è¾‘', 'Markdownæ”¯æŒ', 'æ–‡ç« æ¨¡å¼', 'ä¸»é¢˜æ¨¡å¼']
  },
  // çŸ­å›¾æ–‡å¹³å°
  xiaohongshu_note: {
    id: 'xiaohongshu_note',
    name: 'å°çº¢ä¹¦ï¼ˆå›¾æ–‡ï¼‰',
    icon: 'ğŸ“•',
    color: 'bg-red-500',
    description: 'å°çº¢ä¹¦å›¾æ–‡ç¬”è®°å‘å¸ƒ',
    supportedFeatures: ['æ ‡é¢˜ä¼˜åŒ–', 'æ­£æ–‡å¡«å……', 'è¯é¢˜æ ‡ç­¾', 'äº’åŠ¨å¼•å¯¼']
  },
  weibo: {
    id: 'weibo',
    name: 'å¾®åš',
    icon: 'ğŸ§£',
    color: 'bg-red-600',
    description: 'å¾®åšçŸ­å†…å®¹å‘å¸ƒ',
    supportedFeatures: ['çŸ­æ–‡æ¡ˆ', 'è¯é¢˜æ ‡ç­¾', 'é“¾æ¥å¼•å¯¼']
  },
  jike: {
    id: 'jike',
    name: 'å³åˆ»',
    icon: 'ğŸŸ¡',
    color: 'bg-yellow-500',
    description: 'å³åˆ»åŠ¨æ€å‘å¸ƒ',
    supportedFeatures: ['çŸ­æ–‡æ¡ˆ', 'è¯é¢˜æ ‡ç­¾', 'é“¾æ¥å¼•å¯¼']
  },
  x: {
    id: 'x',
    name: 'X',
    icon: 'ğ•',
    color: 'bg-black',
    description: 'Xï¼ˆTwitterï¼‰çŸ­å¸–å‘å¸ƒ',
    supportedFeatures: ['çŸ­æ–‡æ¡ˆ', 'çº¿ç¨‹æ‹†åˆ†ï¼ˆè§„åˆ’ï¼‰', 'æ ‡ç­¾å»ºè®®ï¼ˆè§„åˆ’ï¼‰']
  },
  linkedin: {
    id: 'linkedin',
    name: 'LinkedIn',
    icon: 'ğŸ’¼',
    color: 'bg-blue-700',
    description: 'LinkedIn èŒä¸šåŠ¨æ€å‘å¸ƒ',
    supportedFeatures: ['çŸ­æ–‡æ¡ˆ', 'è¯é¢˜æ ‡ç­¾', 'é“¾æ¥é¢„è§ˆ']
  },
  video_wechat: {
    id: 'video_wechat',
    name: 'è§†é¢‘å·',
    icon: 'ğŸ“¹',
    color: 'bg-green-600',
    description: 'å¾®ä¿¡è§†é¢‘å·å‘å¸ƒ',
    supportedFeatures: ['å£æ’­ç¨¿è½¬æ¢', 'çŸ­æ ‡é¢˜ç”Ÿæˆ', 'è¯é¢˜æ ‡ç­¾', 'ä½ç½®ä¿¡æ¯', 'åˆé›†ç®¡ç†']
  },
  douyin: {
    id: 'douyin',
    name: 'æŠ–éŸ³',
    icon: 'ğŸµ',
    color: 'bg-black',
    description: 'æŠ–éŸ³çŸ­è§†é¢‘å‘å¸ƒ',
    supportedFeatures: ['çˆ†æ¬¾æ ‡é¢˜', 'çƒ­é—¨æ ‡ç­¾', 'éŸ³ä¹æ¨è', 'å°é¢å»ºè®®', 'å‘å¸ƒæ—¶æœº']
  },
  bilibili: {
    id: 'bilibili',
    name: 'Bç«™',
    icon: 'ğŸ“º',
    color: 'bg-pink-500',
    description: 'Bç«™è§†é¢‘æŠ•ç¨¿',
    supportedFeatures: ['åˆ†åŒºé€‰æ‹©', 'æ ‡ç­¾ä¼˜åŒ–', 'å°é¢è®¾è®¡', 'ç®€ä»‹æ’°å†™', 'æŠ•ç¨¿å£°æ˜']
  },
  xiaohongshu: {
    id: 'xiaohongshu',
    name: 'å°çº¢ä¹¦ï¼ˆè§†é¢‘ï¼‰',
    icon: 'ğŸ“•',
    color: 'bg-red-600',
    description: 'å°çº¢ä¹¦è§†é¢‘å‘å¸ƒ',
    supportedFeatures: ['è§†é¢‘æ ‡é¢˜', 'è§†é¢‘æè¿°', 'è¯é¢˜æ ‡ç­¾', 'å°é¢å»ºè®®']
  },
  youtube: {
    id: 'youtube',
    name: 'YouTube',
    icon: 'ğŸ¬',
    color: 'bg-red-600',
    description: 'YouTube è§†é¢‘å‘å¸ƒ',
    supportedFeatures: ['æ ‡é¢˜ä¼˜åŒ–', 'ç®€ä»‹æ’°å†™', 'æ ‡ç­¾å»ºè®®', 'å°é¢å»ºè®®', 'SEOå…³é”®è¯']
  }
};

// å¹³å°ç±»å‹åˆ¤æ–­å·¥å…·å‡½æ•°
export function isVideoPlatform(platform: Platform): platform is VideoPlatform {
  return ['video_wechat', 'douyin', 'bilibili', 'xiaohongshu', 'youtube'].includes(platform as VideoPlatform);
}

export function isLongTextPlatform(platform: Platform): platform is LongTextPlatform {
  return ['wechat', 'zhihu', 'juejin', 'zsxq'].includes(platform as LongTextPlatform);
}

export function isShortTextPlatform(platform: Platform): platform is ShortTextPlatform {
  return ['wechat_xiaolushu', 'xiaohongshu_note', 'weibo', 'jike', 'x', 'linkedin'].includes(platform as ShortTextPlatform);
}

export function isTextPlatform(platform: Platform): platform is TextPlatform {
  return !isVideoPlatform(platform);
}

// è·å–å¹³å°ç±»å‹
export function getPlatformType(platform: Platform): 'long_text' | 'short_text' | 'video' {
  if (isVideoPlatform(platform)) return 'video';
  return isLongTextPlatform(platform) ? 'long_text' : 'short_text';
}

// è·å–å¹³å°é»˜è®¤é…ç½®ï¼ˆæš‚æ—¶è¿”å›ç©ºå¯¹è±¡ï¼Œæœªæ¥æ‰©å±•æ—¶æ·»åŠ å¹³å°ç‰¹å®šå­—æ®µï¼‰
export function getDefaultPlatformConfig(platform: Platform): PlatformConfig {
  return {};
}
